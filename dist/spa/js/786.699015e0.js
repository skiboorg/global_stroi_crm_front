"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[786],{2637:(e,l,a)=>{a.d(l,{d:()=>n});var o=a(6827),t=a(8346);function n(e,l){o.Z.create({message:l,html:!0,color:e,position:t.Z.lt.sm?"bottom":"bottom-right"})}},4139:(e,l,a)=>{a.d(l,{Z:()=>b});var o=a(9835),t=a(499);const n={class:"row items-center justify-end"},i={__name:"DateInput",props:["label"],emits:["selected"],setup(e,{emit:l}){const a=(0,t.iH)(null),i=(0,t.iH)(null);return(l,t)=>{const u=(0,o.up)("q-btn"),s=(0,o.up)("q-date"),d=(0,o.up)("q-popup-proxy"),p=(0,o.up)("q-icon"),r=(0,o.up)("q-input"),m=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(r,{outlined:"",modelValue:a.value,"onUpdate:modelValue":t[2]||(t[2]=e=>a.value=e),label:e.label},{append:(0,o.w5)((()=>[(0,o.Wm)(p,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),mask:"YYYY-MM-DD"},{default:(0,o.w5)((()=>[(0,o._)("div",n,[(0,o.wy)((0,o.Wm)(u,{onClick:t[0]||(t[0]=e=>l.$emit("selected",i.value)),label:"Выбрать",color:"primary",flat:""},null,512),[[m]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","label"])}}};var u=a(3119),s=a(2857),d=a(2765),p=a(2535),r=a(8879),m=a(2146),c=a(9984),v=a.n(c);const w=i,b=w;v()(i,"components",{QInput:u.Z,QIcon:s.Z,QPopupProxy:d.Z,QDate:p.Z,QBtn:r.Z}),v()(i,"directives",{ClosePopup:m.Z})},6786:(e,l,a)=>{a.r(l),a.d(l,{default:()=>F});var o=a(9835),t=a(6970),n=a(1957),i=a(499),u=a(1569),s=(a(4139),a(6928)),d=a(2637);const p={class:"flex items-center justify-between q-mb-md"},r={class:"no-margin text-h6 text-bold"},m={class:"text-bold"},c={key:0},v={key:1},w={key:2},b={key:3},_={class:"q-gutter-md"},g=(0,o._)("br",null,null,-1),k=(0,o._)("p",null,"Результат выполнения задачи",-1),y=(0,o._)("p",null,null,-1),f={class:"q-mb-md"},q={__name:"user_tasks",setup(e){(0,s.t)();const l=(0,i.iH)(!1),a=(0,i.iH)(!1),q=["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00"],h=[{label:"Низкий",value:1},{label:"Средний",value:2},{label:"Высокий",value:3}],W=(0,i.iH)({priority:1,task:null,dead_line_time:"20:00",is_repeatable:!1}),V=(0,i.iH)([]),Z={sortBy:"desc",descending:!1,page:1,rowsPerPage:25},Q=[{name:"priority",align:"left",label:"Приоритет",field:e=>e.priority,sortable:!0},{name:"task",align:"left",label:"Задача",field:e=>e.task,sortable:!0},{name:"is_done",align:"left",label:"Выполнено",field:e=>e.is_done,sortable:!0},{name:"is_repeatable",align:"left",label:"Ежедневная",field:e=>e.is_repeatable,sortable:!0},{name:"dead_line_date",align:"left",label:"Выполнить до",field:e=>new Date(e.dead_line_date).toLocaleString(),sortable:!0}];(0,o.wF)((async()=>{await x()}));const x=async()=>{const e=await(0,u.api)("/api/form/task");V.value=e.data.results},D=async e=>{l.value=!l.value;await u.api.delete(`/api/form/task/${e}`);await x(),l.value=!l.value},C=async()=>{l.value=!l.value;await u.api.post("/api/form/task",W.value);(0,d.d)("positive","Задача добавлена"),a.value=!1,await x(),l.value=!l.value},j=async e=>{l.value=!l.value,await u.api.patch(`/api/form/task/${e.id}`,{result:e.result}),(0,d.d)("positive","Задача обновлена"),await x(),l.value=!l.value};return(e,i)=>{const u=(0,o.up)("q-space"),s=(0,o.up)("q-btn"),d=(0,o.up)("q-th"),x=(0,o.up)("q-tr"),U=(0,o.up)("q-td"),z=(0,o.up)("q-icon"),H=(0,o.up)("q-badge"),S=(0,o.up)("q-input"),Y=(0,o.up)("q-table"),P=(0,o.up)("q-page"),T=(0,o.up)("q-select"),I=(0,o.up)("q-checkbox"),B=(0,o.up)("q-form"),$=(0,o.up)("q-card-section"),F=(0,o.up)("q-card"),L=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(P,{padding:""},{default:(0,o.w5)((()=>[(0,o._)("div",p,[(0,o._)("p",r,"Задачи на "+(0,t.zw)((new Date).toLocaleDateString()),1),(0,o.Wm)(u),(0,o.Wm)(s,{icon:"add",color:"primary","no-caps":"",unelevated:"",onClick:i[0]||(i[0]=e=>a.value=!0),label:"Добавить задачу"})]),(0,o.Wm)(Y,{flat:"",rows:V.value,columns:Q,"row-key":"id","table-header-class":"table-header",pagination:Z},{header:(0,o.w5)((e=>[(0,o.Wm)(x,{props:e,class:"bg-grey-2"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{"auto-width":""}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(d,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",m,(0,t.zw)(l.label),1)])),_:2},1032,["props"])))),128)),(0,o.Wm)(d,{"auto-width":""})])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[(0,o.Wm)(x,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{size:"sm",color:"accent",round:"",dense:"",onClick:l=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(U,{key:l.name,props:e},{default:(0,o.w5)((()=>["is_done"===l.name?((0,o.wg)(),(0,o.iD)("span",c,[l.value?((0,o.wg)(),(0,o.j4)(z,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,o.wg)(),(0,o.j4)(z,{key:1,name:"close",size:"20px",color:"negative"}))])):"is_repeatable"===l.name?((0,o.wg)(),(0,o.iD)("span",v,[l.value?((0,o.wg)(),(0,o.j4)(z,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,o.wg)(),(0,o.j4)(z,{key:1,name:"close",size:"20px",color:"negative"}))])):"priority"===l.name?((0,o.wg)(),(0,o.iD)("span",w,[1===l.value?((0,o.wg)(),(0,o.j4)(H,{key:0,color:"positive",label:"Низкий"})):2===l.value?((0,o.wg)(),(0,o.j4)(H,{key:1,color:"warning",label:"Средний"})):3===l.value?((0,o.wg)(),(0,o.j4)(H,{key:2,color:"negative",label:"Высокий"})):(0,o.kq)("",!0)])):((0,o.wg)(),(0,o.iD)("span",b,(0,t.zw)(l.value.slice(0,25)+"..."),1))])),_:2},1032,["props"])))),128)),(0,o.Wm)(U,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o._)("div",_,[(0,o.Wm)(s,{disable:e.row.is_done,dense:"",color:"negative",flat:"",icon:"delete",loading:l.value,onClick:l=>D(e.row.id)},null,8,["disable","loading","onClick"])])])),_:2},1024)])),_:2},1032,["props"]),(0,o.wy)((0,o.Wm)(x,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{colspan:"100%"},{default:(0,o.w5)((()=>[(0,o._)("p",null,[(0,o.Uk)("Задача: "),g,(0,o.Uk)((0,t.zw)(e.row.task),1)]),k,(0,o.Wm)(S,{class:"q-mb-md",modelValue:e.row.result,"onUpdate:modelValue":l=>e.row.result=l,dense:"",type:"textarea",outlined:""},null,8,["modelValue","onUpdate:modelValue"]),e.row.is_done?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(s,{key:0,dense:"",color:"positive",icon:"save","no-caps":"",unelevated:"",label:"Задача выполнена",loading:l.value,onClick:l=>j(e.row)},null,8,["loading","onClick"]))])),_:2},1024)])),_:2},1032,["props"]),[[n.F8,e.expand]])])),_:1},8,["rows"])])),_:1}),(0,o.Wm)(L,{modelValue:a.value,"onUpdate:modelValue":i[5]||(i[5]=e=>a.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(F,{style:{width:"700px","max-width":"100vw"}},{default:(0,o.w5)((()=>[(0,o.Wm)($,null,{default:(0,o.w5)((()=>[(0,o.Wm)(B,{onSubmit:(0,n.iM)(C,["prevent"])},{default:(0,o.w5)((()=>[(0,o.Wm)(T,{outlined:"","map-options":"","emit-value":"",behavior:"menu",class:"q-mb-md",modelValue:W.value.priority,"onUpdate:modelValue":i[1]||(i[1]=e=>W.value.priority=e),options:h,label:"Приоритет"},null,8,["modelValue"]),(0,o.Wm)(S,{modelValue:W.value.task,"onUpdate:modelValue":i[2]||(i[2]=e=>W.value.task=e),type:"textarea",label:"Задача *",outlined:"","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),y,(0,o.Wm)(T,{outlined:"","map-options":"","emit-value":"",behavior:"menu",class:"q-mb-md",modelValue:W.value.dead_line_time,"onUpdate:modelValue":i[3]||(i[3]=e=>W.value.dead_line_time=e),options:q,label:`Выполнить ${(new Date).toLocaleDateString()} до`},null,8,["modelValue","label"]),(0,o._)("div",f,[(0,o.Wm)(I,{modelValue:W.value.is_repeatable,"onUpdate:modelValue":i[4]||(i[4]=e=>W.value.is_repeatable=e),label:"Ежедневная задача"},null,8,["modelValue"])]),(0,o.Wm)(s,{icon:"save",color:"positive","no-caps":"",unelevated:"",type:"submit",loading:l.value,label:"Сохранить"},null,8,["loading"])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var h=a(9885),W=a(136),V=a(8879),Z=a(1746),Q=a(1233),x=a(1682),D=a(7220),C=a(2857),j=a(990),U=a(3119),z=a(2074),H=a(4458),S=a(3190),Y=a(8326),P=a(6384),T=a(1006),I=a(9984),B=a.n(I);const $=q,F=$;B()(q,"components",{QPage:h.Z,QSpace:W.Z,QBtn:V.Z,QTable:Z.Z,QTr:Q.Z,QTh:x.Z,QTd:D.Z,QIcon:C.Z,QBadge:j.Z,QInput:U.Z,QDialog:z.Z,QCard:H.Z,QCardSection:S.Z,QForm:Y.Z,QSelect:P.Z,QCheckbox:T.Z})}}]);