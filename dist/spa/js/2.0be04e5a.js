"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[2],{2637:(e,l,a)=>{a.d(l,{d:()=>t});var o=a(6827),n=a(8346);function t(e,l){o.Z.create({message:l,html:!0,color:e,position:n.Z.lt.sm?"bottom":"bottom-right"})}},8550:(e,l,a)=>{a.d(l,{Z:()=>r});var o=a(9835);const n={__name:"AddButton",props:["label","icon","loading","color"],setup(e){return(l,a)=>{const n=(0,o.up)("q-btn");return l.auth.user.role?.permission?.can_add?((0,o.wg)(),(0,o.j4)(n,{key:0,"no-caps":"",unelevated:"",loading:e.loading,color:e.color?e.color:"primary",label:e.label,icon:e.icon?e.icon:"add"},null,8,["loading","color","label","icon"])):(0,o.kq)("",!0)}}};var t=a(8879),u=a(9984),i=a.n(u);const d=n,r=d;i()(n,"components",{QBtn:t.Z})},8203:(e,l,a)=>{a.d(l,{Z:()=>c});var o=a(9835);function n(e,l){const a=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.j4)(a,{"no-caps":"",outline:"",color:"primary",label:"Назад",icon:"arrow_back",class:"q-mr-md",onClick:l[0]||(l[0]=l=>e.$router.back())})}var t=a(1639),u=a(8879),i=a(9984),d=a.n(i);const r={},s=(0,t.Z)(r,[["render",n]]),c=s;d()(r,"components",{QBtn:u.Z})},4139:(e,l,a)=>{a.d(l,{Z:()=>w});var o=a(9835),n=a(499);const t={class:"row items-center justify-end"},u={__name:"DateInput",props:["label"],emits:["selected"],setup(e,{emit:l}){const a=(0,n.iH)(null),u=(0,n.iH)(null);return(l,n)=>{const i=(0,o.up)("q-btn"),d=(0,o.up)("q-date"),r=(0,o.up)("q-popup-proxy"),s=(0,o.up)("q-icon"),c=(0,o.up)("q-input"),p=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(c,{outlined:"",modelValue:a.value,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value=e),label:e.label},{append:(0,o.w5)((()=>[(0,o.Wm)(s,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=e=>u.value=e),mask:"YYYY-MM-DD"},{default:(0,o.w5)((()=>[(0,o._)("div",t,[(0,o.wy)((0,o.Wm)(i,{onClick:n[0]||(n[0]=e=>l.$emit("selected",u.value)),label:"Выбрать",color:"primary",flat:""},null,512),[[p]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","label"])}}};var i=a(3119),d=a(2857),r=a(2765),s=a(2535),c=a(8879),p=a(2146),m=a(9984),v=a.n(m);const b=u,w=b;v()(u,"components",{QInput:i.Z,QIcon:d.Z,QPopupProxy:r.Z,QDate:s.Z,QBtn:c.Z}),v()(u,"directives",{ClosePopup:p.Z})},8227:(e,l,a)=>{a.d(l,{Z:()=>b});var o=a(9835),n=a(499);const t={__name:"DeleteButton",props:["label","icon","loading","color"],emits:["confirm"],setup(e,{emit:l}){const a=(0,n.iH)(!1);return(l,n)=>{const t=(0,o.up)("q-btn"),u=(0,o.up)("q-card-section"),i=(0,o.up)("q-card-actions"),d=(0,o.up)("q-card"),r=(0,o.up)("q-dialog"),s=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[l.auth.user.role?.permission?.can_add?((0,o.wg)(),(0,o.j4)(t,{key:0,"no-caps":"",unelevated:"",dense:"",loading:e.loading,color:e.color?e.color:"negative",label:e.label,onClick:n[0]||(n[0]=e=>a.value=!0),icon:e.icon?e.icon:"delete"},null,8,["loading","color","label","icon"])):(0,o.kq)("",!0),(0,o.Wm)(r,{modelValue:a.value,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{style:{width:"300px","max-width":"100vw"}},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"text-center text-bold"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы уверены? ")])),_:1}),(0,o.Wm)(i,{align:"center"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(t,{color:"negative",unelevated:"","no-caps":"",label:"Да",onClick:n[1]||(n[1]=e=>l.$emit("confirm"))},null,512),[[s]]),(0,o.wy)((0,o.Wm)(t,{color:"positive",unelevated:"","no-caps":"",label:"Нет"},null,512),[[s]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var u=a(8879),i=a(2074),d=a(4458),r=a(3190),s=a(1821),c=a(2146),p=a(9984),m=a.n(p);const v=t,b=v;m()(t,"components",{QBtn:u.Z,QDialog:i.Z,QCard:d.Z,QCardSection:r.Z,QCardActions:s.Z}),m()(t,"directives",{ClosePopup:c.Z})},1862:(e,l,a)=>{a.d(l,{Z:()=>r});var o=a(9835);const n={__name:"EditButton",props:["label","icon","color"],setup(e){return(l,a)=>{const n=(0,o.up)("q-btn");return l.auth.user.role?.permission?.can_edit?((0,o.wg)(),(0,o.j4)(n,{key:0,"no-caps":"",unelevated:"",color:e.color,label:e.label,icon:e.icon?e.icon:"edit"},null,8,["color","label","icon"])):(0,o.kq)("",!0)}}};var t=a(8879),u=a(9984),i=a.n(u);const d=n,r=d;i()(n,"components",{QBtn:t.Z})},1002:(e,l,a)=>{a.r(l),a.d(l,{default:()=>G});var o=a(9835),n=a(6970),t=a(499),u=a(1569),i=a(8550),d=a(1862),r=a(9876),s=a(4139),c=a(2637),p=a(8227);a(8203);const m=(0,o._)("br",null,null,-1),v=(0,o._)("br",null,null,-1),b=(0,o._)("br",null,null,-1),w=(0,o._)("br",null,null,-1),_=(0,o._)("br",null,null,-1),f=(0,o._)("br",null,null,-1),g={class:"flex items-center justify-between q-mb-md"},q=(0,o._)("p",{class:"no-margin text-h6 text-bold"},"Трудовые договора",-1),k={class:"row q-col-gutter-md q-mb-md"},Z={class:"col-12 col-md-10"},y={class:"col-12 col-md-2"},W={class:"text-bold"},h=["innerHTML"],Q={class:"q-gutter-md"},V={key:1},C=["href"],x={__name:"employment_contracts",setup(e){(0,r.E)();const l=[{name:"inner_id",align:"left",label:"Номер",field:e=>e.inner_id,sortable:!0},{name:"date",align:"left",label:"Дата заключения",field:e=>new Date(e.date).toLocaleDateString(),sortable:!0},{name:"worker_fio",align:"left",label:"Ф.И.О сотрудника",field:e=>e.worker_fio,sortable:!0},{name:"period",align:"left",label:"Срок действия",field:e=>e.period,sortable:!0},{name:"file",align:"left",label:"Файл",field:e=>e.file?`<a href="${e.file}" target="_blank">Открыть</a>`:"Нет",sortable:!0}],a=(0,t.iH)(!1),x=((0,t.iH)(!1),(0,t.iH)({}),(0,t.iH)(null),["Бессрочный","1 мес","6 мес","1 год","Другое"]),H=(0,t.iH)({id:null,date:null,worker_fio:null,period:null,file:null}),D={sortBy:"desc",descending:!1,page:1,rowsPerPage:15},U=(0,t.iH)(1),j=(0,t.iH)(!1),B=(0,t.iH)([]),S=(0,t.iH)(5),T=(0,t.iH)(null),P=(0,t.iH)({q:""}),Y=async()=>{console.log(U.value),await $()};(0,o.wF)((async()=>{await $()}));const $=async()=>{j.value=!j.value;const e=await(0,u.api)(`/api/catalog/employment_contract?page=${U.value}&q=${P.value.q}`);B.value=e.data.results,S.value=Math.ceil(e.data.count/15),j.value=!j.value},I=async e=>{await u.api.delete(`/api/catalog/employment_contract/${e}`),await $()},L=e=>{e?(H.value=e,H.value.date=H.value.date?new Date(H.value.date).toLocaleDateString():null):H.value={id:null,date:null,worker_fio:null,period:null,file:null},a.value=!0},M=async()=>{let e,l=new FormData;delete H.value.file;for(let[a,o]of Object.entries(H.value))l.append(a,JSON.stringify(o));T.value&&l.append("file",T.value),e=H.value.id?await(0,u.api)({method:"put",url:`/api/catalog/employment_contract/${H.value.id}`,data:l,headers:{"Content-Type":"multipart/form-data"}}):await(0,u.api)({method:"post",url:"/api/catalog/employment_contract",data:l,headers:{"Content-Type":"multipart/form-data"}}),(0,c.d)(e.data.success?"positive":"negative",e.data.message),await $(),a.value=!1,T.value=null},F=e=>{H.value.date=new Date(e).toLocaleDateString()};return(e,t)=>{const u=(0,o.up)("q-card-section"),r=(0,o.up)("q-card"),c=(0,o.up)("q-expansion-item"),A=(0,o.up)("q-space"),E=(0,o.up)("q-input"),K=(0,o.up)("q-btn"),O=(0,o.up)("q-th"),z=(0,o.up)("q-tr"),J=(0,o.up)("q-td"),N=(0,o.up)("q-table"),G=(0,o.up)("q-pagination"),R=(0,o.up)("q-page"),X=(0,o.up)("q-select"),ee=(0,o.up)("q-file"),le=(0,o.up)("q-card-actions"),ae=(0,o.up)("q-form"),oe=(0,o.up)("q-dialog"),ne=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(R,{padding:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{"expand-separator":"",icon:"help",label:"Описание раздела",class:"q-mb-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" В данный раздел вносятся все трудовые договоры, заключаемые организацией с физическими лицами с обязательным указанием их номеров, даты заключения и срока действия договора."),m,v,(0,o.Uk)(" Номер система создает автоматически, для составления трудового договора укажите номер, следующий за последним номеров, указанным в системе. "),b,w,(0,o.Uk)(" В течение 12 часов трудовой договор можно удалить, в этом случае создавая новый трудовой договор номер будет такой же как в удаленном. "),_,f,(0,o.Uk)(" При создании трудового договора, его электронный образ обязательно необходимо загрузить в систему, в противном случае, нужно будет удалить документ и создать его заново. ")])),_:1})])),_:1})])),_:1}),(0,o._)("div",g,[q,(0,o.Wm)(A),(0,o.Wm)(i.Z,{icon:"add",label:"Добавить",onClick:t[0]||(t[0]=e=>L(null))})]),(0,o._)("div",k,[(0,o._)("div",Z,[(0,o.Wm)(E,{dense:"",modelValue:P.value.q,"onUpdate:modelValue":t[1]||(t[1]=e=>P.value.q=e),label:"Поиск по ФИО сотрудника, сроку действия",outlined:""},null,8,["modelValue"])]),(0,o._)("div",y,[(0,o.Wm)(K,{class:"full-width",label:"Найти","no-caps":"",color:"primary",unelevated:"",onClick:$})])]),(0,o.Wm)(N,{flat:"",rows:B.value,columns:l,"row-key":"name","hide-pagination":"",pagination:D,"onUpdate:pagination":t[2]||(t[2]=e=>D=e),loading:j.value,"table-header-class":"table-header"},{header:(0,o.w5)((e=>[(0,o.Wm)(z,{props:e,class:"bg-grey-2"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(O,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",W,(0,n.zw)(l.label),1)])),_:2},1032,["props"])))),128)),(0,o.Wm)(O,{"auto-width":""})])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[(0,o.Wm)(z,{props:e},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(J,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",{innerHTML:l.value},null,8,h)])),_:2},1032,["props"])))),128)),(0,o.Wm)(J,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o._)("div",Q,[(0,o.Wm)(d.Z,{dense:"",onClick:l=>L(e.row)},null,8,["onClick"]),(0,o.Wm)(p.Z,{onConfirm:l=>I(e.row.id)},null,8,["onConfirm"])])])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["rows","loading"]),(0,o.Wm)(G,{modelValue:U.value,"onUpdate:modelValue":[t[3]||(t[3]=e=>U.value=e),Y],max:S.value,"max-pages":6,"direction-links":"","boundary-numbers":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward"},null,8,["modelValue","max"])])),_:1}),(0,o.Wm)(oe,{modelValue:a.value,"onUpdate:modelValue":t[9]||(t[9]=e=>a.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{style:{width:"700px","max-width":"100vw"}},{default:(0,o.w5)((()=>[(0,o.Wm)(ae,{onSubmit:M},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"q-pb-none"},{default:(0,o.w5)((()=>[H.value.inner_id?((0,o.wg)(),(0,o.j4)(E,{key:0,class:"q-mb-md",outlined:"",dense:"",label:"Внутренний номер",modelValue:H.value.inner_id,"onUpdate:modelValue":t[4]||(t[4]=e=>H.value.inner_id=e)},null,8,["modelValue"])):(0,o.kq)("",!0),(0,o.Wm)(s.Z,{dense:"",class:"q-mb-md",modelValue:H.value.date,"onUpdate:modelValue":t[5]||(t[5]=e=>H.value.date=e),label:"Дата заключения",onSelected:F},null,8,["modelValue"]),(0,o.Wm)(E,{class:"q-mb-md",outlined:"",dense:"",label:"Ф.И.О сотрудника",modelValue:H.value.worker_fio,"onUpdate:modelValue":t[6]||(t[6]=e=>H.value.worker_fio=e)},null,8,["modelValue"]),(0,o.Wm)(X,{outlined:"",dense:"","map-options":"","emit-value":"",behavior:"menu",class:"q-mb-md",modelValue:H.value.period,"onUpdate:modelValue":t[7]||(t[7]=e=>H.value.period=e),options:x,label:"Срок действия"},null,8,["modelValue"]),H.value.file?((0,o.wg)(),(0,o.iD)("p",V,[(0,o._)("a",{href:H.value.file,target:"_blank"},"Загруженный ранее файл",8,C)])):(0,o.kq)("",!0),(0,o.Wm)(ee,{class:"q-mb-md",outlined:"",dense:"",label:"Файл",modelValue:T.value,"onUpdate:modelValue":t[8]||(t[8]=e=>T.value=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(le,{align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(K,{label:"Сохранить",type:"submit","no-caps":"",color:"positive"}),(0,o.wy)((0,o.Wm)(K,{label:"Отмена","no-caps":"",color:"dark"},null,512),[[ne]])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var H=a(9885),D=a(651),U=a(4458),j=a(3190),B=a(136),S=a(3119),T=a(8879),P=a(1746),Y=a(1233),$=a(1682),I=a(7220),L=a(996),M=a(2074),F=a(8326),A=a(6384),E=a(9420),K=a(1821),O=a(2146),z=a(9984),J=a.n(z);const N=x,G=N;J()(x,"components",{QPage:H.Z,QExpansionItem:D.Z,QCard:U.Z,QCardSection:j.Z,QSpace:B.Z,QInput:S.Z,QBtn:T.Z,QTable:P.Z,QTr:Y.Z,QTh:$.Z,QTd:I.Z,QPagination:L.Z,QDialog:M.Z,QForm:F.Z,QSelect:A.Z,QFile:E.Z,QCardActions:K.Z}),J()(x,"directives",{ClosePopup:O.Z})}}]);