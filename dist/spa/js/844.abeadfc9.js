"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[844],{5844:(e,a,l)=>{l.r(a),l.d(a,{default:()=>z});var o=l(9835),t=l(6970),s=l(499),n=l(1569),i=l(6928);const d=(0,o._)("div",{class:"flex items-center justify-between q-mb-md"},[(0,o._)("p",{class:"no-margin text-h6 text-bold"},"Операционные показатели")],-1),r={class:"row q-col-gutter-md"},u={class:"col-12 col-md-3"},c={class:"row items-center justify-end"},p={class:"col-12 col-md-3"},_={class:"col-12 col-md-3"},m={class:"text-bold"},w={key:0},g={key:1},v={key:2},f=(0,o._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,o._)("path",{d:"M5.46967 17.4702C5.17678 17.7631 5.17678 18.2379 5.46967 18.5308C5.76256 18.8237 6.23744 18.8237 6.53033 18.5308L5.46967 17.4702ZM6.53033 18.5308L18.5303 6.53082L17.4697 5.47016L5.46967 17.4702L6.53033 18.5308Z",fill:"#131119"}),(0,o._)("path",{d:"M9 6.00049H18V15.0005",stroke:"#131119","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),b={__name:"stress_forms_for_user",setup(e){const a=(0,i.t)(),l=[{name:"id",align:"left",label:"ID",field:e=>e.id,sortable:!0},{name:"dead_line",align:"left",label:"Крайний срок заполнения",field:e=>new Date(e.dead_line_date).toLocaleDateString(),sortable:!0},{name:"is_done",align:"left",label:"Заполнена",field:e=>e.is_done,sortable:!0},{name:"is_time_left",align:"left",label:"Просрочена",field:e=>e.is_time_left,sortable:!0},{name:"mark",align:"left",label:"Оценка",field:e=>e.rate?e.rate:"Нет оценки",sortable:!0}],b=(0,s.iH)(1),y=(0,s.iH)(!1),k=(0,s.iH)(""),h=(0,s.iH)({sortBy:"desc",descending:!1,page:1,rowsPerPage:15}),x=(0,s.iH)([]),q=(0,s.iH)(5),D=(0,s.iH)({dead_line__exact:null});(0,o.wF)((async()=>{console.log(a.user.id);let e=new Date;e.setDate(e.getDate()),D.value.dead_line__exact=e.toLocaleDateString().split(".").reverse().join("-"),await j("apply")}));const W=async()=>{y.value=!y.value;const e=await(0,n.api)(`/api/form/stress_form_data?user_id=${a.user.id}&page=${b.value}&${k.value}`);console.log(e.data),x.value=e.data.results,q.value=e.data.count/15,y.value=!y.value},Z=async()=>{console.log(b.value),await W()},j=async e=>{if(k.value="","apply"===e)for(let[a,l]of Object.entries(D.value))console.log(a,l),l&&(k.value+=`${a}=${l}&`);"clear"===e&&(k.value="",D.value={dead_line__exact:null}),await W()};return(e,a)=>{const s=(0,o.up)("q-btn"),n=(0,o.up)("q-date"),i=(0,o.up)("q-popup-proxy"),k=(0,o.up)("q-icon"),W=(0,o.up)("q-input"),Q=(0,o.up)("q-th"),H=(0,o.up)("q-tr"),V=(0,o.up)("q-td"),C=(0,o.up)("q-table"),L=(0,o.up)("q-pagination"),P=(0,o.up)("q-page"),z=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(P,{padding:""},{default:(0,o.w5)((()=>[d,(0,o._)("div",r,[(0,o._)("div",u,[(0,o.Wm)(W,{outlined:"",dense:"",modelValue:D.value.dead_line__exact,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.dead_line__exact=e),clearable:"",label:"Крайний срок заполнения"},{append:(0,o.w5)((()=>[(0,o.Wm)(k,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{modelValue:D.value.dead_line__exact,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value.dead_line__exact=e),mask:"YYYY-MM-DD"},{default:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o.wy)((0,o.Wm)(s,{label:"Выбрать",color:"primary",flat:""},null,512),[[z]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,o._)("div",p,[(0,o.wy)((0,o.Wm)(s,{class:"q-mb-sm full-width",label:"Применить фильтр",color:"positive",onClick:a[2]||(a[2]=e=>j("apply")),unelevated:"","no-caps":""},null,512),[[z]])]),(0,o._)("div",_,[(0,o.wy)((0,o.Wm)(s,{class:"full-width",label:"Сбросить фильтр",color:"dark",onClick:a[3]||(a[3]=e=>j("clear")),unelevated:"","no-caps":""},null,512),[[z]])])]),(0,o.Wm)(C,{flat:"",rows:x.value,columns:l,"row-key":"name","table-header-class":"table-header","hide-pagination":"",pagination:h.value,"onUpdate:pagination":a[4]||(a[4]=e=>h.value=e),loading:y.value,class:"q-mb-md"},{header:(0,o.w5)((e=>[(0,o.Wm)(H,{props:e,class:"bg-grey-2"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(a=>((0,o.wg)(),(0,o.j4)(Q,{key:a.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",m,(0,t.zw)(a.label),1)])),_:2},1032,["props"])))),128)),(0,o.Wm)(Q,{"auto-width":""})])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[(0,o.Wm)(H,{props:e},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(a=>((0,o.wg)(),(0,o.j4)(V,{key:a.name,props:e},{default:(0,o.w5)((()=>["is_done"===a.name?((0,o.wg)(),(0,o.iD)("span",w,[a.value?((0,o.wg)(),(0,o.j4)(k,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,o.wg)(),(0,o.j4)(k,{key:1,name:"close",size:"20px",color:"negative"}))])):"is_time_left"===a.name?((0,o.wg)(),(0,o.iD)("span",g,[a.value?((0,o.wg)(),(0,o.j4)(k,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,o.wg)(),(0,o.j4)(k,{key:1,name:"close",size:"20px",color:"negative"}))])):((0,o.wg)(),(0,o.iD)("span",v,(0,t.zw)(a.value),1))])),_:2},1032,["props"])))),128)),(0,o.Wm)(V,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{flat:"",round:"",dense:"",to:`/form/user_stress_form/${e.row.uuid}`},{default:(0,o.w5)((()=>[f])),_:2},1032,["to"])])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["rows","pagination","loading"]),(0,o.Wm)(L,{modelValue:b.value,"onUpdate:modelValue":[a[5]||(a[5]=e=>b.value=e),Z],max:q.value,"max-pages":6,"direction-links":"","boundary-numbers":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward"},null,8,["modelValue","max"])])),_:1})}}};var y=l(9885),k=l(3119),h=l(2857),x=l(2765),q=l(2535),D=l(8879),W=l(1746),Z=l(1233),j=l(1682),Q=l(7220),H=l(996),V=l(2146),C=l(9984),L=l.n(C);const P=b,z=P;L()(b,"components",{QPage:y.Z,QInput:k.Z,QIcon:h.Z,QPopupProxy:x.Z,QDate:q.Z,QBtn:D.Z,QTable:W.Z,QTr:Z.Z,QTh:j.Z,QTd:Q.Z,QPagination:H.Z}),L()(b,"directives",{ClosePopup:V.Z})}}]);