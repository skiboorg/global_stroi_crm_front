"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[620],{3620:(e,l,a)=>{a.r(l),a.d(l,{default:()=>X});var t=a(9835),o=a(6970),n=a(499),i=a(1569),s=a(6928),u=a(9876);const d=(0,t._)("br",null,null,-1),r=(0,t._)("br",null,null,-1),c=(0,t._)("br",null,null,-1),m=(0,t._)("br",null,null,-1),_=(0,t._)("div",{class:"flex items-center justify-between q-mb-md"},[(0,t._)("p",{class:"no-margin text-h6 text-bold"},"Операционые показатели")],-1),p={class:"q-mb-md"},w={class:"row q-col-gutter-md q-mb-md"},v={class:"col-12 col-md-3"},f={class:"row items-center justify-end"},g={class:"col-12 col-md-3"},b={class:"col-12 col-md-3"},k={class:"row items-center justify-end"},y={class:"row items-center justify-end"},h={class:"col-12 col-md-3"},W={class:"text-bold"},x={key:0},q={key:1},V={key:2},D={key:3},Z=(0,t._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,t._)("path",{d:"M5.46967 17.4702C5.17678 17.7631 5.17678 18.2379 5.46967 18.5308C5.76256 18.8237 6.23744 18.8237 6.53033 18.5308L5.46967 17.4702ZM6.53033 18.5308L18.5303 6.53082L17.4697 5.47016L5.46967 17.4702L6.53033 18.5308Z",fill:"#131119"}),(0,t._)("path",{d:"M9 6.00049H18V15.0005",stroke:"#131119","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Q={__name:"stress_forms_for_admin",setup(e){const l=(0,s.t)(),a=(0,u.E)(),Q=(0,n.iH)([]),U=(0,n.iH)(""),j=[{name:"id",align:"left",label:"ID",field:e=>e.id,sortable:!0},{name:"user",align:"left",label:"Пользователь",field:e=>e.user.fio,sortable:!0},{name:"created_at",align:"left",label:"Создана",field:e=>new Date(e.created_at).toLocaleDateString(),sortable:!0},{name:"dead_line",align:"left",label:"Крайний срок заполнения",field:e=>new Date(e.dead_line_date).toLocaleDateString(),sortable:!0},{name:"is_done",align:"left",label:"Заполнена",field:e=>e.is_done,sortable:!0},{name:"is_time_left",align:"left",label:"Просрочена",field:e=>e.is_time_left,sortable:!0},{name:"mark",align:"left",label:"Оценка",field:e=>e.rate?e.rate:"Нет оценки",sortable:!0},{name:"comment_user",align:"left",label:"Обратная связь",field:e=>e.rate?e.user_comment:"Еще нет",sortable:!0}],Y=(0,n.iH)({user__id:null,is_done:!1,is_time_left:!1,created_at_gte:null,created_at_lte:null,dead_line__exact:null}),H=(0,n.iH)(1),z=(0,n.iH)(!1),C=(0,n.iH)({sortBy:"desc",descending:!1,page:1,rowsPerPage:15}),M=(0,n.iH)([]),L=(0,n.iH)(5);(0,t.wF)((async()=>{console.log(l.user.id);let e=new Date;e.setDate(e.getDate()),Y.value.dead_line__exact=e.toLocaleDateString().split(".").reverse().join("-"),await S("apply");const t=await a.getUsers(null,!0);Q.value=t}));const P=async()=>{z.value=!z.value;const e=await(0,i.api)(`/api/form/stress_form_data?all=true&page=${H.value}&${U.value}`);console.log(e.data),M.value=e.data.results,L.value=Math.ceil(e.data.count/15),z.value=!z.value},I=async()=>{console.log(H.value),await P()},S=async e=>{if(U.value="",Y.value.is_done||(U.value=""),"apply"===e)for(let[l,a]of Object.entries(Y.value))console.log(l,a),a&&(U.value+=`${l}=${a}&`);"clear"===e&&(U.value="",Y.value={user__id:null,is_done:!1,is_time_left:!1,created_at_gte:null,created_at_lte:null,dead_line__exact:null}),await P()},T=(e,l)=>{l((async()=>{e&&(z.value=!z.value,z.value=!z.value)}))};return(e,l)=>{const a=(0,t.up)("q-card-section"),n=(0,t.up)("q-card"),i=(0,t.up)("q-expansion-item"),s=(0,t.up)("q-item-label"),u=(0,t.up)("q-item-section"),U=(0,t.up)("q-item"),P=(0,t.up)("q-select"),$=(0,t.up)("q-btn"),B=(0,t.up)("q-date"),F=(0,t.up)("q-popup-proxy"),E=(0,t.up)("q-icon"),K=(0,t.up)("q-input"),O=(0,t.up)("q-checkbox"),A=(0,t.up)("q-th"),G=(0,t.up)("q-tr"),J=(0,t.up)("q-td"),N=(0,t.up)("q-table"),R=(0,t.up)("q-pagination"),X=(0,t.up)("q-page"),ee=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(X,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{"expand-separator":"",icon:"help",label:"Описание раздела",class:"q-mb-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Операционные показатели – те действия, которые прямо или косвенно влияют на финансовый результат организации. "),d,r,(0,t.Uk)(" Программа ежедневно собирает данные с пользователей о выполнении ими конкретных показателей и в процентном отношении сравнивает их с выставленным администратором планом на день. Например, количество звонков клиенту – План 10 /Факт 5, план выполнен на 50 процентов."),c,m,(0,t.Uk)(" Сбор данных позволяет руководителю контролировать количество прилагаемых сотрудником усилий по достижению результата. В случае необходимости система позволит скорректировать показатели пользователя или план по его усилиям. ")])),_:1})])),_:1})])),_:1}),_,(0,t._)("div",p,[(0,t._)("div",w,[(0,t._)("div",v,[(0,t.Wm)(P,{class:"q-mb-xs",dense:"",outlined:"",modelValue:Y.value.user__id,"onUpdate:modelValue":l[0]||(l[0]=e=>Y.value.user__id=e),loading:z.value,options:Q.value,"option-label":"fio",label:"Выберите пользователя","map-options":"","option-value":"id","emit-value":"","use-input":"",onFilter:T,"fill-input":"",clearable:""},{option:(0,t.w5)((e=>[(0,t.Wm)(U,(0,o.vs)((0,t.F4)(e.itemProps)),{default:(0,t.w5)((()=>[(0,t.Wm)(u,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.opt.role?.name),1)])),_:2},1024),(0,t.Wm)(s,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Роль")])),_:1})])),_:2},1024),(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Wm)(s,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.opt.fio),1)])),_:2},1024),(0,t.Wm)(s,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)("ФИО")])),_:1})])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","loading","options"]),(0,t.Wm)(K,{outlined:"",dense:"",modelValue:Y.value.dead_line__exact,"onUpdate:modelValue":l[2]||(l[2]=e=>Y.value.dead_line__exact=e),label:"Крайний срок заполнения"},{append:(0,t.w5)((()=>[(0,t.Wm)(E,{name:"event",class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:Y.value.dead_line__exact,"onUpdate:modelValue":l[1]||(l[1]=e=>Y.value.dead_line__exact=e),mask:"YYYY-MM-DD"},{default:(0,t.w5)((()=>[(0,t._)("div",f,[(0,t.wy)((0,t.Wm)($,{label:"Выбрать",color:"primary",flat:""},null,512),[[ee]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,t._)("div",g,[(0,t.Wm)(O,{label:"Заполненые",modelValue:Y.value.is_done,"onUpdate:modelValue":l[3]||(l[3]=e=>Y.value.is_done=e)},null,8,["modelValue"])]),(0,t._)("div",b,[(0,t.Wm)(K,{class:"q-mb-xs",outlined:"",dense:"",modelValue:Y.value.created_at_gte,"onUpdate:modelValue":l[5]||(l[5]=e=>Y.value.created_at_gte=e),label:"Дата создания от"},{append:(0,t.w5)((()=>[(0,t.Wm)(E,{name:"event",class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:Y.value.created_at_gte,"onUpdate:modelValue":l[4]||(l[4]=e=>Y.value.created_at_gte=e),mask:"YYYY-MM-DD"},{default:(0,t.w5)((()=>[(0,t._)("div",k,[(0,t.wy)((0,t.Wm)($,{label:"Выбрать",color:"primary",flat:""},null,512),[[ee]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(K,{outlined:"",dense:"",modelValue:Y.value.created_at_lte,"onUpdate:modelValue":l[7]||(l[7]=e=>Y.value.created_at_lte=e),label:"Дата создания до"},{append:(0,t.w5)((()=>[(0,t.Wm)(E,{name:"event",class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:Y.value.created_at_lte,"onUpdate:modelValue":l[6]||(l[6]=e=>Y.value.created_at_lte=e),mask:"YYYY-MM-DD"},{default:(0,t.w5)((()=>[(0,t._)("div",y,[(0,t.wy)((0,t.Wm)($,{label:"Выбрать",color:"primary",flat:""},null,512),[[ee]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,t._)("div",h,[(0,t.wy)((0,t.Wm)($,{class:"q-mb-sm full-width",label:"Применить фильтр",color:"positive",onClick:l[8]||(l[8]=e=>S("apply")),unelevated:"","no-caps":""},null,512),[[ee]]),(0,t.wy)((0,t.Wm)($,{class:"full-width",label:"Сбросить фильтр",color:"dark",onClick:l[9]||(l[9]=e=>S("clear")),unelevated:"","no-caps":""},null,512),[[ee]])])])]),(0,t.Wm)(N,{flat:"",rows:M.value,columns:j,"row-key":"name","table-header-class":"table-header","hide-pagination":"",pagination:C.value,"onUpdate:pagination":l[10]||(l[10]=e=>C.value=e),loading:z.value,class:"q-mb-md"},{header:(0,t.w5)((e=>[(0,t.Wm)(G,{props:e,class:"bg-grey-2"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(A,{key:l.name,props:e},{default:(0,t.w5)((()=>[(0,t._)("span",W,(0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128)),(0,t.Wm)(A,{"auto-width":""})])),_:2},1032,["props"])])),body:(0,t.w5)((e=>[(0,t.Wm)(G,{props:e},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(J,{key:l.name,props:e},{default:(0,t.w5)((()=>["is_done"===l.name?((0,t.wg)(),(0,t.iD)("span",x,[l.value?((0,t.wg)(),(0,t.j4)(E,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,t.wg)(),(0,t.j4)(E,{key:1,name:"close",size:"20px",color:"negative"}))])):"is_time_left"===l.name?((0,t.wg)(),(0,t.iD)("span",q,[l.value?((0,t.wg)(),(0,t.j4)(E,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,t.wg)(),(0,t.j4)(E,{key:1,name:"close",size:"20px",color:"negative"}))])):"comment"===l.name?((0,t.wg)(),(0,t.iD)("span",V,[l.value?((0,t.wg)(),(0,t.j4)(E,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,t.wg)(),(0,t.j4)(E,{key:1,name:"close",size:"20px",color:"negative"}))])):((0,t.wg)(),(0,t.iD)("span",D,(0,o.zw)(l.value),1))])),_:2},1032,["props"])))),128)),(0,t.Wm)(J,{"auto-width":""},{default:(0,t.w5)((()=>[(0,t.Wm)($,{flat:"",round:"",dense:"",to:`/form/filled_stress_form/${e.row.uuid}`},{default:(0,t.w5)((()=>[Z])),_:2},1032,["to"])])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["rows","pagination","loading"]),(0,t.Wm)(R,{modelValue:H.value,"onUpdate:modelValue":[l[11]||(l[11]=e=>H.value=e),I],max:L.value,"max-pages":6,"direction-links":"","boundary-numbers":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward"},null,8,["modelValue","max"])])),_:1})}}};var U=a(9885),j=a(651),Y=a(4458),H=a(3190),z=a(6384),C=a(490),M=a(6749),L=a(3115),P=a(3119),I=a(2857),S=a(2765),T=a(4939),$=a(8879),B=a(1006),F=a(1746),E=a(1233),K=a(1682),O=a(7220),A=a(996),G=a(2146),J=a(9984),N=a.n(J);const R=Q,X=R;N()(Q,"components",{QPage:U.Z,QExpansionItem:j.Z,QCard:Y.Z,QCardSection:H.Z,QSelect:z.Z,QItem:C.Z,QItemSection:M.Z,QItemLabel:L.Z,QInput:P.Z,QIcon:I.Z,QPopupProxy:S.Z,QDate:T.Z,QBtn:$.Z,QCheckbox:B.Z,QTable:F.Z,QTr:E.Z,QTh:K.Z,QTd:O.Z,QPagination:A.Z}),N()(Q,"directives",{ClosePopup:G.Z})}}]);