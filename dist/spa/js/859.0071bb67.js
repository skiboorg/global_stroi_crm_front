"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[859],{8550:(e,l,a)=>{a.d(l,{Z:()=>d});var t=a(9835);const o={__name:"AddButton",props:["label","icon","loading","color"],setup(e){return(l,a)=>{const o=(0,t.up)("q-btn");return l.auth.user.role?.permission?.can_add?((0,t.wg)(),(0,t.j4)(o,{key:0,"no-caps":"",unelevated:"",loading:e.loading,color:e.color?e.color:"primary",label:e.label,icon:e.icon?e.icon:"add"},null,8,["loading","color","label","icon"])):(0,t.kq)("",!0)}}};var n=a(8879),r=a(9984),u=a.n(r);const s=o,d=s;u()(o,"components",{QBtn:n.Z})},1862:(e,l,a)=>{a.d(l,{Z:()=>d});var t=a(9835);const o={__name:"EditButton",props:["label","icon","color"],setup(e){return(l,a)=>{const o=(0,t.up)("q-btn");return l.auth.user.role?.permission?.can_edit?((0,t.wg)(),(0,t.j4)(o,{key:0,"no-caps":"",unelevated:"",color:e.color,label:e.label,icon:e.icon?e.icon:"edit"},null,8,["color","label","icon"])):(0,t.kq)("",!0)}}};var n=a(8879),r=a(9984),u=a.n(r);const s=o,d=s;u()(o,"components",{QBtn:n.Z})},9859:(e,l,a)=>{a.r(l),a.d(l,{default:()=>K});var t=a(9835),o=a(6970),n=a(499),r=a(1569),u=(a(8550),a(1862),a(9876));const s=(0,t._)("br",null,null,-1),d=(0,t._)("br",null,null,-1),i=(0,t._)("br",null,null,-1),c=(0,t._)("br",null,null,-1),_=(0,t._)("br",null,null,-1),m=(0,t._)("br",null,null,-1),p=(0,t._)("br",null,null,-1),b=(0,t._)("br",null,null,-1),w=(0,t._)("div",{class:"flex items-center justify-between q-mb-md"},[(0,t._)("p",{class:"no-margin text-h6 text-bold"},"Оценки")],-1),v={class:"row q-col-gutter-md q-mb-lg"},f={class:"col-12 col-md-9"},g={class:"row items-center justify-end"},k={class:"row items-center justify-end"},q={class:"col-12 col-md-3"},W={class:"text-bold"},y={__name:"marks",setup(e){const l=(0,u.E)(),a=[{name:"username",align:"left",label:"ФИО",field:e=>e.user.fio,sortable:!0},{name:"middle_logins_mark",align:"left",label:"Количество усилий",field:e=>e.middle_logins_mark,sortable:!0},{name:"middle_task_mark",align:"left",label:"Качество усилий",field:e=>e.middle_task_mark,sortable:!0},{name:"middle_forms_mark",align:"left",label:"Операционные результаты",field:e=>e.middle_forms_mark,sortable:!0},{name:"total_mark",align:"left",label:"Общая оценка",field:e=>e.total_mark,sortable:!0}],y={sortBy:"desc",descending:!1,page:1,rowsPerPage:100},Z=(0,n.iH)({user__id:null,created_at_gte:"",created_at_lte:""}),h=(0,n.iH)([]),Q=(0,n.iH)([]),U=(0,n.iH)(!1),V=((0,n.iH)(null),(0,n.iH)({q:"",role__id:""}),async()=>{Z.value.user__id?h.value=h.value.filter((e=>e.user.id===Z.value.user__id)):await j()});(0,t.wF)((async()=>{let e=new Date;e.setDate(e.getDate()-1),Z.value.created_at_gte=e.toLocaleDateString().split(".").reverse().join("-"),Z.value.created_at_lte=e.toLocaleDateString().split(".").reverse().join("-"),await D(),Q.value=await l.getUsers(null,!0)}));const D=async()=>{const e=await(0,r.api)(`/api/report/marks?created_at_gte=${Z.value.created_at_gte}&created_at_lte=${Z.value.created_at_lte}`);h.value=e.data,Z.value.user__id&&(h.value=h.value.filter((e=>e.user.id===Z.value.user__id)))},x=async()=>{await D()},j=async()=>{Z.value={user__id:null,created_at_gte:"",created_at_lte:""},await D()};return(e,l)=>{const n=(0,t.up)("q-card-section"),r=(0,t.up)("q-card"),u=(0,t.up)("q-expansion-item"),D=(0,t.up)("q-item-label"),Y=(0,t.up)("q-item-section"),H=(0,t.up)("q-item"),C=(0,t.up)("q-select"),P=(0,t.up)("q-btn"),B=(0,t.up)("q-date"),I=(0,t.up)("q-popup-proxy"),T=(0,t.up)("q-icon"),S=(0,t.up)("q-input"),z=(0,t.up)("q-th"),M=(0,t.up)("q-tr"),E=(0,t.up)("q-td"),L=(0,t.up)("q-table"),F=(0,t.up)("q-page"),K=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(F,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{"expand-separator":"",icon:"help",label:"Описание раздела",class:"q-mb-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" Оценки – это сводная ведомость оценок за вчерашний день."),s,d,(0,t.Uk)(" Общая оценка пользователя определяется путем сложения оценок за следующие показатели:"),i,c,(0,t.Uk)(" 1. Количество усилий (время, которое пользователь провел в системе) оценивается системой автоматически по количеству авторизаций в системе. Четыре авторизации оценка 5, три авторизации оценка 4, две авторизации оценка 3, меньше двух оценка 2"),_,(0,t.Uk)(" 2. Качество усилий (оценка выполненных задач пользователя деленное на их количество)"),m,(0,t.Uk)(" 3. Операционные результаты (оценка за выполнение операционных показателей)"),p,b,(0,t.Uk)(" Средняя оценка определяется путем сложения всех оценок и деления на их количество. Если общая оценка дробная, то округляется до целой по математическим правилам. ")])),_:1})])),_:1})])),_:1}),w,(0,t._)("div",v,[(0,t._)("div",f,[(0,t.Wm)(C,{class:"q-mb-xs",dense:"",outlined:"",modelValue:Z.value.user__id,"onUpdate:modelValue":[l[0]||(l[0]=e=>Z.value.user__id=e),V],loading:U.value,options:Q.value.filter((e=>e.role?.use_in_report)),"option-label":"fio",label:"Выберите пользователя","map-options":"","option-value":"id","emit-value":"","use-input":"",clearable:""},{option:(0,t.w5)((e=>[(0,t.Wm)(H,(0,o.vs)((0,t.F4)(e.itemProps)),{default:(0,t.w5)((()=>[(0,t.Wm)(Y,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.opt.role?.name),1)])),_:2},1024),(0,t.Wm)(D,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)("Роль")])),_:1})])),_:2},1024),(0,t.Wm)(Y,null,{default:(0,t.w5)((()=>[(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.opt.fio),1)])),_:2},1024),(0,t.Wm)(D,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)("ФИО")])),_:1})])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","loading","options"]),(0,t.Wm)(S,{class:"q-mb-xs",outlined:"",dense:"",modelValue:Z.value.created_at_gte,"onUpdate:modelValue":l[2]||(l[2]=e=>Z.value.created_at_gte=e),label:"Отчет с"},{append:(0,t.w5)((()=>[(0,t.Wm)(T,{name:"event",class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:Z.value.created_at_gte,"onUpdate:modelValue":l[1]||(l[1]=e=>Z.value.created_at_gte=e),mask:"YYYY-MM-DD"},{default:(0,t.w5)((()=>[(0,t._)("div",g,[(0,t.wy)((0,t.Wm)(P,{label:"Выбрать",color:"primary",flat:""},null,512),[[K]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(S,{outlined:"",dense:"",modelValue:Z.value.created_at_lte,"onUpdate:modelValue":l[4]||(l[4]=e=>Z.value.created_at_lte=e),label:"Отчет до"},{append:(0,t.w5)((()=>[(0,t.Wm)(T,{name:"event",class:"cursor-pointer"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:Z.value.created_at_lte,"onUpdate:modelValue":l[3]||(l[3]=e=>Z.value.created_at_lte=e),mask:"YYYY-MM-DD"},{default:(0,t.w5)((()=>[(0,t._)("div",k,[(0,t.wy)((0,t.Wm)(P,{label:"Выбрать",color:"primary",flat:""},null,512),[[K]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,t._)("div",q,[(0,t.wy)((0,t.Wm)(P,{class:"q-mb-sm full-width",label:"Применить фильтр",color:"positive",onClick:x,unelevated:"","no-caps":""},null,512),[[K]]),(0,t.wy)((0,t.Wm)(P,{class:"full-width",label:"Сбросить фильтр",color:"dark",onClick:j,unelevated:"","no-caps":""},null,512),[[K]])])]),(0,t.Wm)(L,{flat:"",rows:h.value,columns:a,"row-key":"name","hide-pagination":"","table-header-class":"table-header",pagination:y},{header:(0,t.w5)((e=>[(0,t.Wm)(M,{props:e,class:"bg-grey-2"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(z,{key:l.name,props:e},{default:(0,t.w5)((()=>[(0,t._)("span",W,(0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,t.w5)((e=>[(0,t.Wm)(M,{props:e},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(E,{key:l.name,props:e},{default:(0,t.w5)((()=>[(0,t._)("span",null,(0,o.zw)(l.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),_:1},8,["rows"])])),_:1})}}};var Z=a(9885),h=a(651),Q=a(4458),U=a(3190),V=a(6384),D=a(490),x=a(6749),j=a(3115),Y=a(3119),H=a(2857),C=a(2765),P=a(2535),B=a(8879),I=a(1746),T=a(1233),S=a(1682),z=a(7220),M=a(2146),E=a(9984),L=a.n(E);const F=y,K=F;L()(y,"components",{QPage:Z.Z,QExpansionItem:h.Z,QCard:Q.Z,QCardSection:U.Z,QSelect:V.Z,QItem:D.Z,QItemSection:x.Z,QItemLabel:j.Z,QInput:Y.Z,QIcon:H.Z,QPopupProxy:C.Z,QDate:P.Z,QBtn:B.Z,QTable:I.Z,QTr:T.Z,QTh:S.Z,QTd:z.Z}),L()(y,"directives",{ClosePopup:M.Z})}}]);