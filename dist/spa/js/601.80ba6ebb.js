"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[601],{8550:(e,l,a)=>{a.d(l,{Z:()=>c});var o=a(9835);const n={__name:"AddButton",props:["label","icon","loading","color"],setup(e){return(l,a)=>{const n=(0,o.up)("q-btn");return l.auth.user.role?.permission?.can_add?((0,o.wg)(),(0,o.j4)(n,{key:0,"no-caps":"",unelevated:"",loading:e.loading,color:e.color?e.color:"primary",label:e.label,icon:e.icon?e.icon:"add"},null,8,["loading","color","label","icon"])):(0,o.kq)("",!0)}}};var t=a(8879),u=a(9984),i=a.n(u);const d=n,c=d;i()(n,"components",{QBtn:t.Z})},1862:(e,l,a)=>{a.d(l,{Z:()=>c});var o=a(9835);const n={__name:"EditButton",props:["label","icon","color"],setup(e){return(l,a)=>{const n=(0,o.up)("q-btn");return l.auth.user.role?.permission?.can_edit?((0,o.wg)(),(0,o.j4)(n,{key:0,"no-caps":"",unelevated:"",color:e.color,label:e.label,icon:e.icon?e.icon:"edit"},null,8,["color","label","icon"])):(0,o.kq)("",!0)}}};var t=a(8879),u=a(9984),i=a.n(u);const d=n,c=d;i()(n,"components",{QBtn:t.Z})},4601:(e,l,a)=>{a.r(l),a.d(l,{default:()=>Y});var o=a(9835),n=a(6970),t=a(1957),u=a(499),i=a(1569),d=a(8550),c=a(1862),s=a(9876);const r={class:"flex items-center justify-between q-mb-md"},p=(0,o._)("p",{class:"no-margin text-h6 text-bold"},"Объекты ",-1),m={class:"text-bold"},w={class:"q-gutter-md"},_={class:"q-mb-md flex items-center justify-between"},b=(0,o._)("p",{class:"no-margin text-bold"},"Контакты",-1),v={class:"q-gutter-md"},W={__name:"objects",setup(e){(0,s.E)();const l=[{name:"name",align:"left",label:"Название объекта",field:e=>e.name,sortable:!0}],a=(0,u.iH)(!1),W=(0,u.iH)(!1),g=((0,u.iH)(null),(0,u.iH)({id:null,name:null})),f=(0,u.iH)({id:null,object_id:null,name:null,phone:null}),k={sortBy:"desc",descending:!1,page:1,rowsPerPage:25},q=(0,u.iH)([]);(0,u.iH)({q:"",role__id:""});(0,o.wF)((async()=>{await Z()}));const Z=async()=>{const e=await(0,i.api)("/api/material_store/object");q.value=e.data},h=async e=>{await i.api.delete(`/api/material_store/object/${e}`),await Z()},y=async e=>{await i.api.delete(`/api/material_store/object_contact/${e}`),await Z()},C=e=>{g.value=e||{name:null},a.value=!0},Q=(e,l)=>{console.log(e),f.value=e||{name:null,phone:null,object:l},W.value=!0},j=async()=>{g.value.id?await i.api.put(`/api/material_store/object/${g.value.id}`,g.value):await i.api.post("/api/material_store/object",g.value),a.value=!1,await Z()},V=async()=>{f.value.id?await i.api.put(`/api/material_store/object_contact/${f.value.id}`,f.value):await i.api.post("/api/material_store/object_contact",f.value),W.value=!1,await Z()};return(e,u)=>{const i=(0,o.up)("q-space"),s=(0,o.up)("q-th"),Z=(0,o.up)("q-tr"),H=(0,o.up)("q-btn"),x=(0,o.up)("q-td"),U=(0,o.up)("q-item-label"),B=(0,o.up)("q-item-section"),T=(0,o.up)("q-item"),z=(0,o.up)("q-list"),D=(0,o.up)("q-table"),I=(0,o.up)("q-page"),P=(0,o.up)("q-input"),Y=(0,o.up)("q-card-section"),$=(0,o.up)("q-card-actions"),K=(0,o.up)("q-card"),S=(0,o.up)("q-dialog"),A=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(I,{padding:""},{default:(0,o.w5)((()=>[(0,o._)("div",r,[p,(0,o.Wm)(i),(0,o.Wm)(d.Z,{icon:"add",label:"Добавить объект",onClick:u[0]||(u[0]=e=>C(null))})]),(0,o.Wm)(D,{flat:"",rows:q.value,columns:l,"row-key":"name","table-header-class":"table-header",pagination:k},{header:(0,o.w5)((e=>[(0,o.Wm)(Z,{props:e,class:"bg-grey-2"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{"auto-width":""}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(s,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",m,(0,n.zw)(l.label),1)])),_:2},1032,["props"])))),128)),(0,o.Wm)(s,{"auto-width":""})])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[(0,o.Wm)(Z,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{size:"sm",color:"accent",round:"",dense:"",onClick:l=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(x,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,n.zw)(l.value),1)])),_:2},1032,["props"])))),128)),(0,o.Wm)(x,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o._)("div",w,[(0,o.Wm)(c.Z,{dense:"",onClick:l=>C(e.row)},null,8,["onClick"]),(0,o.Wm)(d.Z,{dense:"",color:"negative",icon:"delete",onClick:l=>h(e.row.id)},null,8,["onClick"])])])),_:2},1024)])),_:2},1032,["props"]),(0,o.wy)((0,o.Wm)(Z,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{colspan:"100%"},{default:(0,o.w5)((()=>[(0,o._)("div",_,[b,(0,o.Wm)(d.Z,{icon:"add",label:"Добавить контакт",onClick:l=>Q(null,e.row.id)},null,8,["onClick"])]),(0,o.Wm)(z,{dense:"",separator:"",bordered:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.row.contacts,(l=>((0,o.wg)(),(0,o.j4)(T,{key:l.id},{default:(0,o.w5)((()=>[(0,o.Wm)(B,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,{overline:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Название")])),_:1}),(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(l.name),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(B,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,{overline:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Телефон")])),_:1}),(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(l.phone),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(B,{side:""},{default:(0,o.w5)((()=>[(0,o._)("div",v,[(0,o.Wm)(c.Z,{dense:"",onClick:a=>Q(l,e.row.id)},null,8,["onClick"]),(0,o.Wm)(d.Z,{dense:"",color:"negative",icon:"delete",onClick:e=>y(l.id)},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"]),[[t.F8,e.expand]])])),_:1},8,["rows"])])),_:1}),(0,o.Wm)(S,{modelValue:a.value,"onUpdate:modelValue":u[2]||(u[2]=e=>a.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(K,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{class:"q-pb-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{outlined:"",label:"Введите название",modelValue:g.value.name,"onUpdate:modelValue":u[1]||(u[1]=e=>g.value.name=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)($,{align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{label:"Сохранить",disable:!g.value.name,"no-caps":"",color:"positive",onClick:j},null,8,["disable"]),(0,o.wy)((0,o.Wm)(H,{label:"Отмена","no-caps":"",color:"dark"},null,512),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(S,{modelValue:W.value,"onUpdate:modelValue":u[5]||(u[5]=e=>W.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(K,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{class:"q-pb-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{outlined:"",label:"Введите название контакта",modelValue:f.value.name,"onUpdate:modelValue":u[3]||(u[3]=e=>f.value.name=e)},null,8,["modelValue"]),(0,o.Wm)(P,{outlined:"",label:"Введите телефон",modelValue:f.value.phone,"onUpdate:modelValue":u[4]||(u[4]=e=>f.value.phone=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)($,{align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{label:"Сохранить",disable:!f.value.name,"no-caps":"",color:"positive",onClick:V},null,8,["disable"]),(0,o.wy)((0,o.Wm)(H,{label:"Отмена","no-caps":"",color:"dark"},null,512),[[A]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var g=a(9885),f=a(136),k=a(1746),q=a(1233),Z=a(1682),h=a(7220),y=a(8879),C=a(3246),Q=a(490),j=a(6749),V=a(3115),H=a(2074),x=a(4458),U=a(3190),B=a(3119),T=a(1821),z=a(2146),D=a(9984),I=a.n(D);const P=W,Y=P;I()(W,"components",{QPage:g.Z,QSpace:f.Z,QTable:k.Z,QTr:q.Z,QTh:Z.Z,QTd:h.Z,QBtn:y.Z,QList:C.Z,QItem:Q.Z,QItemSection:j.Z,QItemLabel:V.Z,QDialog:H.Z,QCard:x.Z,QCardSection:U.Z,QInput:B.Z,QCardActions:T.Z}),I()(W,"directives",{ClosePopup:z.Z})}}]);