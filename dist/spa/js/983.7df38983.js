"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[983],{8550:(e,l,a)=>{a.d(l,{Z:()=>u});var o=a(9835);const n={__name:"AddButton",props:["label","icon","loading","color"],setup(e){return(l,a)=>{const n=(0,o.up)("q-btn");return l.auth.user.role?.permission?.can_add?((0,o.wg)(),(0,o.j4)(n,{key:0,"no-caps":"",unelevated:"",loading:e.loading,color:e.color?e.color:"primary",label:e.label,icon:e.icon?e.icon:"add"},null,8,["loading","color","label","icon"])):(0,o.kq)("",!0)}}};var t=a(8879),s=a(9984),i=a.n(s);const r=n,u=r;i()(n,"components",{QBtn:t.Z})},1862:(e,l,a)=>{a.d(l,{Z:()=>u});var o=a(9835);const n={__name:"EditButton",props:["label","icon","color"],setup(e){return(l,a)=>{const n=(0,o.up)("q-btn");return l.auth.user.role?.permission?.can_edit?((0,o.wg)(),(0,o.j4)(n,{key:0,"no-caps":"",unelevated:"",color:e.color,label:e.label,icon:e.icon?e.icon:"edit"},null,8,["color","label","icon"])):(0,o.kq)("",!0)}}};var t=a(8879),s=a(9984),i=a.n(s);const r=n,u=r;i()(n,"components",{QBtn:t.Z})},6983:(e,l,a)=>{a.r(l),a.d(l,{default:()=>y});a(2879);var o=a(9835),n=a(6970),t=a(499),s=a(1569),i=(a(8550),a(1862),a(9876));const r=(0,o._)("div",{class:"flex items-center justify-between q-mb-md"},[(0,o._)("p",{class:"no-margin text-h6 text-bold"},"Отчеты по пользователям")],-1),u={class:"text-bold"},p={__name:"index",setup(e){const l=(0,i.E)(),a=[{name:"firstname",align:"left",label:"ФИО",field:e=>e.fio,sortable:!0},{name:"username",align:"left",label:"Логин",field:e=>e.username,sortable:!0},{name:"role",align:"left",label:"Роль",field:e=>e.role?.name,sortable:!0},{name:"position",align:"left",label:"Телефон",field:e=>e.phone,sortable:!0}],p={sortBy:"desc",descending:!1,page:1,rowsPerPage:100},c=(0,t.iH)([]),d=(0,t.iH)([]),m=(0,t.iH)(!1),_=(0,t.iH)(null),b=(0,t.iH)({q:"",role__id:""}),w=async()=>{_.value?c.value=c.value.filter((e=>e.id===_.value)):c.value=await l.getUsers(`q=${b.value.q}&role__id=${b.value.role__id}`,!0)};(0,o.wF)((async()=>{await g(),d.value=await l.getUsers(null,!0)}));const g=async()=>{c.value=await l.getUsers(`q=${b.value.q}&role__id=${b.value.role__id}`,!0)},v=(e,l)=>{l((async()=>{if(e){m.value=!m.value;const l=await(0,s.api)(`/api/user/user?q=${e}&page_size=10000`);d.value=l.data,m.value=!m.value}}))};return(e,l)=>{const t=(0,o.up)("q-item-label"),s=(0,o.up)("q-item-section"),i=(0,o.up)("q-item"),b=(0,o.up)("q-select"),g=(0,o.up)("q-th"),f=(0,o.up)("q-tr"),q=(0,o.up)("q-td"),k=(0,o.up)("q-table"),h=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(h,{padding:""},{default:(0,o.w5)((()=>[r,(0,o.Wm)(b,{class:"q-mb-xs",dense:"",outlined:"",modelValue:_.value,"onUpdate:modelValue":[l[0]||(l[0]=e=>_.value=e),w],loading:m.value,options:d.value,"option-label":"fio",label:"Выберите пользователя","map-options":"","option-value":"id","emit-value":"","use-input":"",onFilter:v,clearable:""},{option:(0,o.w5)((e=>[(0,o.Wm)(i,(0,n.vs)((0,o.F4)(e.itemProps)),{default:(0,o.w5)((()=>[(0,o.Wm)(s,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.opt.role?.name),1)])),_:2},1024),(0,o.Wm)(t,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)("Роль")])),_:1})])),_:2},1024),(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.opt.fio),1)])),_:2},1024),(0,o.Wm)(t,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)("ФИО")])),_:1})])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","loading","options"]),(0,o.Wm)(k,{flat:"",rows:c.value,columns:a,"row-key":"name","table-header-class":"table-header",pagination:p},{header:(0,o.w5)((e=>[(0,o.Wm)(f,{props:e,class:"bg-grey-2"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(g,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",u,(0,n.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((l=>[(0,o.Wm)(f,{props:l},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.cols,(a=>((0,o.wg)(),(0,o.j4)(q,{key:a.name,onClick:a=>e.auth.user.role.permission.can_view?e.$router.push(`/reports/report/${l.row.id}`):null,props:l},{default:(0,o.w5)((()=>[(0,o._)("span",null,(0,n.zw)(a.value),1)])),_:2},1032,["onClick","props"])))),128))])),_:2},1032,["props"])])),_:1},8,["rows"])])),_:1})}}};var c=a(9885),d=a(6384),m=a(490),_=a(6749),b=a(3115),w=a(1746),g=a(1233),v=a(1682),f=a(7220),q=a(9984),k=a.n(q);const h=p,y=h;k()(p,"components",{QPage:c.Z,QSelect:d.Z,QItem:m.Z,QItemSection:_.Z,QItemLabel:b.Z,QTable:w.Z,QTr:g.Z,QTh:v.Z,QTd:f.Z})}}]);