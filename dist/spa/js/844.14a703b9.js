"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[844],{5844:(e,a,l)=>{l.r(a),l.d(a,{default:()=>T});var o=l(9835),t=l(6970),s=l(499),n=l(1569),i=l(6928),d=l(1375);const r=(0,o._)("div",{class:"flex items-center justify-between q-mb-md"},[(0,o._)("p",{class:"no-margin text-h6 text-bold"},"Операционные показатели")],-1),u={class:"row q-col-gutter-md"},c={class:"col-12 col-md-3"},p={class:"row items-center justify-end"},_={class:"col-12 col-md-3"},m={class:"col-12 col-md-3"},w={class:"text-bold"},g={key:0},v={key:1},f={key:2},b=(0,o._)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,o._)("path",{d:"M5.46967 17.4702C5.17678 17.7631 5.17678 18.2379 5.46967 18.5308C5.76256 18.8237 6.23744 18.8237 6.53033 18.5308L5.46967 17.4702ZM6.53033 18.5308L18.5303 6.53082L17.4697 5.47016L5.46967 17.4702L6.53033 18.5308Z",fill:"#131119"}),(0,o._)("path",{d:"M9 6.00049H18V15.0005",stroke:"#131119","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),y={__name:"stress_forms_for_user",setup(e){const a=(0,i.t)(),l=[{name:"id",align:"left",label:"ID",field:e=>e.id,sortable:!0},{name:"dead_line",align:"left",label:"Крайний срок заполнения",field:e=>new Date(e.dead_line_date).toLocaleDateString(),sortable:!0},{name:"is_done",align:"left",label:"Заполнена",field:e=>e.is_done,sortable:!0},{name:"is_time_left",align:"left",label:"Просрочена",field:e=>e.is_time_left,sortable:!0},{name:"mark",align:"left",label:"Оценка",field:e=>e.rate?e.rate:"Нет оценки",sortable:!0}],y=(0,s.iH)(1),k=(0,s.iH)(!1),h=(0,s.iH)(""),x=(0,s.iH)({sortBy:"desc",descending:!1,page:1,rowsPerPage:15}),q=(0,s.iH)([]),D=(0,s.iH)(5),W=(0,s.iH)({dead_line__exact:null});(0,o.wF)((async()=>{console.log(a.user.id);let e=new Date;e.setDate(e.getDate()),W.value.dead_line__exact=e.toLocaleDateString().split(".").reverse().join("-"),await Q("apply")}));const Z=async()=>{k.value=!k.value;const e=await(0,n.api)(`/api/form/stress_form_data?user_id=${a.user.id}&page=${y.value}&${h.value}`);console.log(e.data),q.value=e.data.results,D.value=e.data.count/15,k.value=!k.value},j=async()=>{console.log(y.value),await Z()},Q=async e=>{if(h.value="","apply"===e)for(let[a,l]of Object.entries(W.value))console.log(a,l),l&&(h.value+=`${a}=${l}&`);"clear"===e&&(h.value="",W.value={dead_line__exact:null}),await Z()};return(e,a)=>{const s=(0,o.up)("q-btn"),n=(0,o.up)("q-date"),i=(0,o.up)("q-popup-proxy"),h=(0,o.up)("q-icon"),Z=(0,o.up)("q-input"),H=(0,o.up)("q-th"),V=(0,o.up)("q-tr"),C=(0,o.up)("q-td"),L=(0,o.up)("q-table"),P=(0,o.up)("q-pagination"),z=(0,o.up)("q-page"),T=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(z,{padding:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d.Z),r,(0,o._)("div",u,[(0,o._)("div",c,[(0,o.Wm)(Z,{outlined:"",dense:"",modelValue:W.value.dead_line__exact,"onUpdate:modelValue":a[1]||(a[1]=e=>W.value.dead_line__exact=e),clearable:"",label:"Крайний срок заполнения"},{append:(0,o.w5)((()=>[(0,o.Wm)(h,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{modelValue:W.value.dead_line__exact,"onUpdate:modelValue":a[0]||(a[0]=e=>W.value.dead_line__exact=e),mask:"YYYY-MM-DD"},{default:(0,o.w5)((()=>[(0,o._)("div",p,[(0,o.wy)((0,o.Wm)(s,{label:"Выбрать",color:"primary",flat:""},null,512),[[T]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,o._)("div",_,[(0,o.wy)((0,o.Wm)(s,{class:"q-mb-sm full-width",label:"Применить фильтр",color:"positive",onClick:a[2]||(a[2]=e=>Q("apply")),unelevated:"","no-caps":""},null,512),[[T]])]),(0,o._)("div",m,[(0,o.wy)((0,o.Wm)(s,{class:"full-width",label:"Сбросить фильтр",color:"dark",onClick:a[3]||(a[3]=e=>Q("clear")),unelevated:"","no-caps":""},null,512),[[T]])])]),(0,o.Wm)(L,{flat:"",rows:q.value,columns:l,"row-key":"name","table-header-class":"table-header","hide-pagination":"",pagination:x.value,"onUpdate:pagination":a[4]||(a[4]=e=>x.value=e),loading:k.value,class:"q-mb-md"},{header:(0,o.w5)((e=>[(0,o.Wm)(V,{props:e,class:"bg-grey-2"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(a=>((0,o.wg)(),(0,o.j4)(H,{key:a.name,props:e},{default:(0,o.w5)((()=>[(0,o._)("span",w,(0,t.zw)(a.label),1)])),_:2},1032,["props"])))),128)),(0,o.Wm)(H,{"auto-width":""})])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[(0,o.Wm)(V,{props:e},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(a=>((0,o.wg)(),(0,o.j4)(C,{key:a.name,props:e},{default:(0,o.w5)((()=>["is_done"===a.name?((0,o.wg)(),(0,o.iD)("span",g,[a.value?((0,o.wg)(),(0,o.j4)(h,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,o.wg)(),(0,o.j4)(h,{key:1,name:"close",size:"20px",color:"negative"}))])):"is_time_left"===a.name?((0,o.wg)(),(0,o.iD)("span",v,[a.value?((0,o.wg)(),(0,o.j4)(h,{key:0,name:"check_circle",size:"20px",color:"positive"})):((0,o.wg)(),(0,o.j4)(h,{key:1,name:"close",size:"20px",color:"negative"}))])):((0,o.wg)(),(0,o.iD)("span",f,(0,t.zw)(a.value),1))])),_:2},1032,["props"])))),128)),(0,o.Wm)(C,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{flat:"",round:"",dense:"",to:`/form/user_stress_form/${e.row.uuid}`},{default:(0,o.w5)((()=>[b])),_:2},1032,["to"])])),_:2},1024)])),_:2},1032,["props"])])),_:1},8,["rows","pagination","loading"]),(0,o.Wm)(P,{modelValue:y.value,"onUpdate:modelValue":[a[5]||(a[5]=e=>y.value=e),j],max:D.value,"max-pages":6,"direction-links":"","boundary-numbers":"","icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward"},null,8,["modelValue","max"])])),_:1})}}};var k=l(9885),h=l(3119),x=l(2857),q=l(2765),D=l(4939),W=l(8879),Z=l(1746),j=l(1233),Q=l(1682),H=l(7220),V=l(996),C=l(2146),L=l(9984),P=l.n(L);const z=y,T=z;P()(y,"components",{QPage:k.Z,QInput:h.Z,QIcon:x.Z,QPopupProxy:q.Z,QDate:D.Z,QBtn:W.Z,QTable:Z.Z,QTr:j.Z,QTh:Q.Z,QTd:H.Z,QPagination:V.Z}),P()(y,"directives",{ClosePopup:C.Z})}}]);