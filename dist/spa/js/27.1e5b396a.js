"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[27],{5027:(e,l,a)=>{a.r(l),a.d(l,{default:()=>z});var u=a(9835),n=a(1957),o=a(8203),t=a(499),s=(a(8550),a(2637)),m=a(8339),r=a(1569),d=a(9876),i=(a(1862),a(6928));const p={class:"flex items-center q-mb-md"},v=(0,u._)("p",{class:"no-margin text-h6 text-bold"},"Профиль пользователя",-1),c={key:0,class:"q-mb-md"},b=["src"],g={class:"row q-col-gutter-md q-mb-md"},f={class:"col-12 col-md-6"},V={__name:"profile",setup(e){const l=(0,d.E)(),a=((0,m.tv)(),(0,m.yj)(),(0,t.iH)(!1)),V=(0,t.iH)(""),{user:_,getUser:h}=(0,i.t)(),w=(0,t.iH)(null),q=(0,t.iH)({username:null,fio:null,phone:null,email:null,telega_username:null,password:null});(0,u.Fl)((()=>l.departments));(0,u.wF)((async()=>{q.value.username=_.username,q.value.fio=_.fio,q.value.phone=_.phone,q.value.email=_.email,q.value.telega_username=_.telega_username}));const y=async()=>{a.value=!a.value,V.value="";let e=new FormData;for(let[l,a]of Object.entries(q.value))e.append(l,JSON.stringify(a));w.value&&e.append("avatar",w.value),(0,r.api)({method:"patch",url:`/api/user/user/${_.id}`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then((e=>{(0,s.d)("positive","Пользователь успешно изменен")})).catch((e=>{let l=Object.keys(e.response.data);for(let a of l)V.value+=e.response.data[a][0];(0,s.d)("negative",V.value)})),await h(),a.value=!a.value};return(e,l)=>{const t=(0,u.up)("q-avatar"),s=(0,u.up)("q-input"),m=(0,u.up)("q-file"),r=(0,u.up)("q-btn"),d=(0,u.up)("q-form"),i=(0,u.up)("q-page");return(0,u.wg)(),(0,u.j4)(i,{padding:""},{default:(0,u.w5)((()=>[(0,u._)("div",p,[(0,u.Wm)(o.Z),v]),q.value.avatar?((0,u.wg)(),(0,u.iD)("div",c,[(0,u.Wm)(t,{size:"100px"},{default:(0,u.w5)((()=>[(0,u._)("img",{src:q.value.avatar},null,8,b)])),_:1})])):(0,u.kq)("",!0),(0,u.Wm)(d,{onSubmit:(0,n.iM)(y,["prevent"])},{default:(0,u.w5)((()=>[(0,u._)("div",g,[(0,u._)("div",f,[(0,u.Wm)(s,{outlined:"",modelValue:q.value.username,"onUpdate:modelValue":l[0]||(l[0]=e=>q.value.username=e),label:"Логин*","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(s,{outlined:"",modelValue:q.value.password,"onUpdate:modelValue":l[1]||(l[1]=e=>q.value.password=e),class:"q-mb-md",label:"Новый пароль"},null,8,["modelValue"]),(0,u.Wm)(s,{outlined:"",modelValue:q.value.telega_username,"onUpdate:modelValue":l[2]||(l[2]=e=>q.value.telega_username=e),label:"Telegram username ID (без символа@)*","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(s,{outlined:"",modelValue:q.value.fio,"onUpdate:modelValue":l[3]||(l[3]=e=>q.value.fio=e),label:"ФИО*","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(s,{outlined:"",modelValue:q.value.phone,"onUpdate:modelValue":l[4]||(l[4]=e=>q.value.phone=e),label:"Телефон*","lazy-rules":"",mask:"+7 (###) ###-##-##","fill-mask":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(s,{outlined:"",modelValue:q.value.email,"onUpdate:modelValue":l[5]||(l[5]=e=>q.value.email=e),label:"Email*","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,u.Wm)(m,{outlined:"",modelValue:w.value,"onUpdate:modelValue":l[6]||(l[6]=e=>w.value=e),class:"q-mb-md",label:"Фото"},null,8,["modelValue"])])]),(0,u.Wm)(r,{loading:a.value,"no-caps":"",unelevated:"",label:"Сохранить изменения",type:"submit",color:"positive",icon:"done"},null,8,["loading"])])),_:1},8,["onSubmit"])])),_:1})}}};var _=a(9885),h=a(1357),w=a(8326),q=a(3119),y=a(3837),W=a(8879),k=a(9984),U=a.n(k);const Z=V,z=Z;U()(V,"components",{QPage:_.Z,QAvatar:h.Z,QForm:w.Z,QInput:q.Z,QFile:y.Z,QBtn:W.Z})}}]);