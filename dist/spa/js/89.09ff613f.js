"use strict";(globalThis["webpackChunkglobal_stroi_crm_front"]=globalThis["webpackChunkglobal_stroi_crm_front"]||[]).push([[89],{8203:(e,l,a)=>{a.d(l,{Z:()=>r});var o=a(9835);function u(e,l){const a=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.j4)(a,{"no-caps":"",outline:"",color:"primary",label:"Назад",icon:"arrow_back",class:"q-mr-md",onClick:l[0]||(l[0]=l=>e.$router.back())})}var t=a(1639),n=a(8879),s=a(9984),i=a.n(s);const d={},m=(0,t.Z)(d,[["render",u]]),r=m;i()(d,"components",{QBtn:n.Z})},5089:(e,l,a)=>{a.r(l),a.d(l,{default:()=>F});a(2879);var o=a(9835),u=a(1957),t=a(6970),n=a(8203),s=a(499),i=a(1569);const d={class:"flex items-center q-mb-md"},m=(0,o._)("p",{class:"no-margin text-h6 text-bold"},"Карточка передачи оборудования",-1),r={key:0},p={key:1,class:"q-mb-md"},c={key:2},v={key:3},_={class:"row items-center justify-end"},w={key:4,class:"row q-col-gutter-md text-bold text-body1"},b=(0,o._)("div",{class:"col-1"},"№",-1),y=(0,o._)("div",{class:"col-6"},"Товар",-1),V=(0,o._)("div",{class:"col-2"},"Ед. измерения",-1),g=(0,o._)("div",{class:"col-2"},"Кол-во",-1),k=(0,o._)("div",{class:"col-1"},null,-1),h=[b,y,V,g,k],q={class:"col-1"},W={class:"col-6"},U={class:"col-2"},Z={class:"col-2"},f={class:"col-1"},z={__name:"add_card",setup(e){const l=(0,s.iH)([]),a=(0,s.iH)([]),b=(0,s.iH)([]),y=(0,s.iH)([]),V=(0,s.iH)(!1),g=(0,s.iH)(!1),k=(0,s.iH)([]),z=(0,s.iH)({name:null,contact:{name:null,phone:null}}),H=(0,s.iH)({name:null}),Q=(0,s.iH)({object:null,sender:null,receiver:null,want_supply_date:null});(0,o.wF)((async()=>{await j()}));const j=async()=>{const e=await(0,i.api)("/api/material_store/object");l.value=e.data;const o=await(0,i.api)("/api/material_store/supplier?page_size=500");a.value=o.data.results;const u=await(0,i.api)("/api/material_store/item");b.value=u.data;const t=await(0,i.api)("/api/material_store/unit");y.value=t.data},C=()=>{k.value.push({item:null,amount:null,unit:null})},D=e=>{k.value.splice(e,1)},x=e=>{let l=e.split(".");return`${l[2]}-${l[1]}-${l[0]}`},S=async()=>{Q.value.want_supply_date=x(Q.value.want_supply_date);const e=await i.api.post("/api/material_store/card",{newObject:z.value,newSupplier:H.value,newItems:k.value,newCard:Q.value,needNewSupplier:g.value,needNewObject:V.value});console.log(e.data)};return(e,s)=>{const i=(0,o.up)("q-select"),j=(0,o.up)("q-input"),x=(0,o.up)("q-btn"),Y=(0,o.up)("q-date"),P=(0,o.up)("q-popup-proxy"),$=(0,o.up)("q-icon"),I=(0,o.up)("q-form"),M=(0,o.up)("q-page"),B=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(M,{padding:""},{default:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o.Wm)(n.Z),m]),(0,o.Wm)(I,{onSubmit:(0,u.iM)(S,["prevent"])},{default:(0,o.w5)((()=>[V.value?((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(j,{outlined:"",modelValue:z.value.name,"onUpdate:modelValue":s[1]||(s[1]=e=>z.value.name=e),label:"Название объекта","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,o.Wm)(j,{outlined:"",modelValue:z.value.contact.name,"onUpdate:modelValue":s[2]||(s[2]=e=>z.value.contact.name=e),label:"Название получателя","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"]),(0,o.Wm)(j,{outlined:"",modelValue:z.value.contact.phone,"onUpdate:modelValue":s[3]||(s[3]=e=>z.value.contact.phone=e),label:"Телефон получателя"},null,8,["modelValue"])])):((0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(i,{outlined:"","option-label":"name",options:l.value,modelValue:Q.value.object,"onUpdate:modelValue":s[0]||(s[0]=e=>Q.value.object=e),label:"Выберите объект","lazy-rules":"",rules:[e=>e||"Это обязательное поле"]},null,8,["options","modelValue","rules"])])),g.value?((0,o.wg)(),(0,o.iD)("div",v,[(0,o.Wm)(j,{outlined:"",modelValue:H.value.name,"onUpdate:modelValue":s[5]||(s[5]=e=>H.value.name=e),label:"Название поставщика","lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","rules"])])):((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(i,{outlined:"","option-label":"name",options:a.value,modelValue:Q.value.sender,"onUpdate:modelValue":s[4]||(s[4]=e=>Q.value.sender=e),label:"Выберите поставщика","lazy-rules":"",rules:[e=>e||"Это обязательное поле"]},null,8,["options","modelValue","rules"])])),(0,o.Wm)(j,{outlined:"",modelValue:Q.value.want_supply_date,"onUpdate:modelValue":s[7]||(s[7]=e=>Q.value.want_supply_date=e),"lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"],label:"Ожидаемая дата поставки"},{append:(0,o.w5)((()=>[(0,o.Wm)($,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{modelValue:Q.value.want_supply_date,"onUpdate:modelValue":s[6]||(s[6]=e=>Q.value.want_supply_date=e),mask:"DD.MM.YYYY"},{default:(0,o.w5)((()=>[(0,o._)("div",_,[(0,o.wy)((0,o.Wm)(x,{label:"Close",color:"primary",flat:""},null,512),[[B]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),(0,o.Wm)(x,{label:"Добавить товар",icon:"add",color:"primary","no-caps":"",class:"q-mb-md",onClick:C}),k.value.length>0?((0,o.wg)(),(0,o.iD)("div",w,h)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(k.value,((e,l)=>((0,o.wg)(),(0,o.iD)("div",{class:"row q-col-gutter-md",key:l},[(0,o._)("div",q,(0,t.zw)(l+1),1),(0,o._)("div",W,[(0,o.Wm)(i,{outlined:"",options:b.value,"option-label":"name",modelValue:e.item,"onUpdate:modelValue":l=>e.item=l,"lazy-rules":"",rules:[e=>e||"Это обязательное поле"]},null,8,["options","modelValue","onUpdate:modelValue","rules"])]),(0,o._)("div",U,[(0,o.Wm)(i,{outlined:"",options:y.value,"option-label":"name",modelValue:e.unit,"onUpdate:modelValue":l=>e.unit=l,"lazy-rules":"",rules:[e=>e||"Это обязательное поле"]},null,8,["options","modelValue","onUpdate:modelValue","rules"])]),(0,o._)("div",Z,[(0,o.Wm)(j,{outlined:"",type:"number",modelValue:e.amount,"onUpdate:modelValue":l=>e.amount=l,"lazy-rules":"",rules:[e=>e&&e.length>0||"Это обязательное поле"]},null,8,["modelValue","onUpdate:modelValue","rules"])]),(0,o._)("div",f,[(0,o.Wm)(x,{icon:"delete",color:"negative",onClick:e=>D(l)},null,8,["onClick"])])])))),128)),k.value.length>0?((0,o.wg)(),(0,o.j4)(x,{key:5,type:"submit",label:"Сохранить",icon:"save",color:"primary","no-caps":"",class:"q-mb-md"})):(0,o.kq)("",!0)])),_:1},8,["onSubmit"])])),_:1})}}};var H=a(9885),Q=a(8326),j=a(1006),C=a(6384),D=a(3119),x=a(2857),S=a(2765),Y=a(2535),P=a(8879),$=a(2146),I=a(9984),M=a.n(I);const B=z,F=B;M()(z,"components",{QPage:H.Z,QForm:Q.Z,QCheckbox:j.Z,QSelect:C.Z,QInput:D.Z,QIcon:x.Z,QPopupProxy:S.Z,QDate:Y.Z,QBtn:P.Z}),M()(z,"directives",{ClosePopup:$.Z})}}]);